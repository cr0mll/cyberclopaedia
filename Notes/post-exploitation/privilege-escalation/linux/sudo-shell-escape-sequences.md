# Sudo Shell Escape Sequences

It is common to see a low-privileged user to be configured to be able to run some commands via `sudo` without a password.

![](<../../../Post Exploitation/Privilege Escalation/Linux/Resources/Images/Sudo Shell Escape Sequences/List Sudo.png>)

Luckily, many existing programmes for Linux have advanced capabilities which allow them to do many things such as spawning a shell when run with `sudo`. If such a programme is configured in the aforementioned way, then there is a _shell escape sequence_ which is a (usually) simple command/argument passed to the programme when run, so that it spawns a shell with elevated privileges when run with `sudo`.

Naturally, these shell escape sequences are programme-specific and it would be inane to try and remember the sequence for every binary. This is where [GTFOBins](https://gtfobins.github.io/) comes in. This is a database of commands (including shell escape sequences) for common Linux binaries which can be used for escalating privileges.

We saw in the above list provided by `sudo -l` that we are allowed to run `find` as root via sudo. Let's check if there is a shell escape sequence for it.

![](<../../../Post Exploitation/Privilege Escalation/Linux/Resources/Images/Sudo Shell Escape Sequences/GTFOBins Find Search.png>)

![](<../../../Post Exploitation/Privilege Escalation/Linux/Resources/Images/Sudo Shell Escape Sequences/Find GTFOBins.png>)

There is! We can copy and paste it, then run it with `sudo`, and we should at last have a root shell:

![](<../../../Post Exploitation/Privilege Escalation/Linux/Resources/Images/Sudo Shell Escape Sequences/Find Escape Sequence.png>)

Another example can be given with the `awk` binary, which we also saw in the list provided by `sudo -l`.

![](<../../../Post Exploitation/Privilege Escalation/Linux/Resources/Images/Sudo Shell Escape Sequences/Awk Escape Sequence.png>)
